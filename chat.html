<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport"
            content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta name="description"
            content="TDStudio ‚Äì Trang h·ªó tr·ª£ b·ªüi Bot Chat.">
        <meta name="robots" content="index, follow, max-image-preview:large">
        <title>TDStudio ‚Äì Chat Bot H·ªó Tr·ª£ Nhanh</title>

        <meta property="og:locale" content="vi_VN">
        <meta property="og:type" content="website">
        <meta property="og:site_name" content="TDStudio">
        <meta property="og:title"
            content="TDStudio ‚Äì Trang h·ªó tr·ª£ b·ªüi Bot Chat.">
        <meta property="og:description"
            content="TDStudio ‚Äì Trang h·ªó tr·ª£ b·ªüi Bot Chat.">
        <meta property="og:url" content="https://thanhdi.com/chat">
        <meta property="og:image"
            content="https://sv1.thanhdi.games/static/sonic/img/graph.png?v=123">

        <link rel="icon"
            href="https://sv1.thanhdi.games/static/sonic/img/favicon.png?v=12">
        <style>
:root{
    --brand:#2563eb;
    --bg:#eef2f7;
    --card:#ffffff;
    --bot:#f1f5f9;
    --border:#e5e7eb;
    --text:#111827;
    --muted:#6b7280;
}

*{box-sizing:border-box}

body{
    margin:0;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    background:var(--bg);
}

/* ===== WRAP ===== */
.wrap{
    max-width:420px;
    height:100vh;
    margin:auto;
    display:flex;
    flex-direction:column;
    background:var(--card);
    box-shadow:0 0 0 1px var(--border);
}

/* ===== HEADER ===== */
.header{
    padding:14px 12px 12px;
    background:linear-gradient(135deg,#020617,#0f172a);
    color:#fff;
    text-align:center;
}

.header .title{
    font-weight:700;
    font-size:15px;
}

.header .sub{
    font-size:12px;
    opacity:.8;
    margin-top:2px;
}

/* ===== CHAT ===== */
.chat{
    flex:1;
    overflow-y:auto;
    padding:16px 12px;
    background:#f8fafc;
}

/* ===== MESSAGE ===== */
.msg{
    max-width:82%;
    margin-bottom:10px;
    font-size:14.5px;
    line-height:1.45;
    word-wrap:break-word;
}

.msg.user{
    margin-left:auto;
    background:var(--brand);
    color:#fff;
    padding:10px 14px;
    border-radius:18px 18px 4px 18px;
}

.msg.bot{
    background:var(--bot);
    color:var(--text);
    padding:10px 14px;
    border-radius:18px 18px 18px 4px;
}

/* ===== BUTTONS ===== */
.buttons{
    margin:6px 0 14px;
    display:flex;
    flex-direction:column;
    gap:8px;
}

.buttons a{
    display:flex;
    justify-content:center;
    padding:12px 16px;
    border-radius:999px;
    background:#fff;
    border:1px solid var(--border);
    color:var(--brand);
    font-weight:600;
    font-size:14px;
    text-decoration:none;
}

.buttons a:active{
    transform:scale(.97);
}

/* ===== INPUT ===== */
.input{
    display:flex;
    gap:8px;
    padding:10px;
    border-top:1px solid var(--border);
    background:#fff;
}

.input input{
    flex:1;
    border:1px solid var(--border);
    border-radius:999px;
    padding:12px 14px;
    font-size:14px;
    outline:none;
}

.input input:focus{
    border-color:var(--brand);
}

.input button{
    border:none;
    background:var(--brand);
    color:#fff;
    padding:0 18px;
    border-radius:999px;
    font-size:14px;
    font-weight:600;
}

/* ===== EMPTY STATE ===== */
.empty-box{
    max-width:300px;
}

.empty-box{
    max-width:300px;
}

.empty-title{
    font-weight:700;
    font-size:16px;
    margin-bottom:8px;
}

.empty-text{
    font-size:15.5px;
    color:#4b5563;
    line-height:1.65;
    margin-bottom:16px;
}

.empty-btn{
    display:inline-block;
    padding:12px 18px;
    border-radius:999px;
    background:var(--brand);
    color:#fff;
    font-weight:600;
    font-size:14px;
    text-decoration:none;
}
</style>
    </head>

    <body>

        <div class="wrap">
            <div class="header">
                <div class="title">TDStudio ‚Äì H·ªó Tr·ª£ B·ªüi Bot</div>
                <div class="sub">Tr·ª±c 24/24 ¬∑ Fanpage ¬∑ Website ¬∑ Game</div>
            </div>

            <div id="chat" class="chat">
                <div id="emptyState" class="empty">
                    <div class="empty-box">
                        <div class="empty-title">B·∫°n c√≥ th·ªÉ h·ªèi v·ªÅ:</div>
                        <div class="empty-text">
                            ‚Ä¢ C√°ch t·∫£i game<br>
                            ‚Ä¢ V·∫≠t ph·∫©m, item<br>
                            ‚Ä¢ H∆∞·ªõng d·∫´n kƒ© thu·∫≠t<br>
                            ‚Ä¢ Ch·ª©c nƒÉng, nhi·ªám v·ª•<br><br>
                            Ho·∫∑c chat tr·ª±c ti·∫øp v·ªõi Admin t·∫°i Fanpage
                        </div>
                        <a class="empty-btn"
                            href="https://www.facebook.com/tdstudiogame"
                            target="_blank">
                            üëâ Chat v·ªõi Admin Fanpage
                        </a>
                    </div>
                </div>
            </div>

            <div class="input">
                <input id="txt" placeholder="Nh·∫≠p n·ªôi dung c·∫ßn h·ªó tr·ª£‚Ä¶" />
                <button onclick="send()">G·ª≠i</button>
            </div>
        </div>

        <script>
const RULES_URL =
"https://raw.githubusercontent.com/kietsieudz/text/refs/heads/main/support_messenger.txt";
const MAX_REPLIES = 10;

let RULE_LINES = [];

fetch(RULES_URL)
  .then(r => r.text())
  .then(t => {
    RULE_LINES = t.split("\n").map(l => l.trim()).filter(Boolean);
  });

function normalize(s){
  return s.toLowerCase()
    .normalize("NFD").replace(/[\u0300-\u036f]/g,"")
    .replace(/\s+/g," ").trim();
}

function spin(text){
  while(true){
    const m = text.match(/\[([^\]]+)\]/);
    if(!m) return text;
    const opts = m[1].split("|");
    text = text.replace(m[0],
      opts[Math.floor(Math.random()*opts.length)]
    );
  }
}

function phraseMatch(text, kw){
  const r = new RegExp(`(^|\\W)${kw}(\\W|$)`);
  return r.test(text);
}

function parseBTN(reply){
  const lines = reply.split("\n").map(l=>l.trim()).filter(Boolean);
  if(!lines[0]?.startsWith("BTN:")) return null;

  const text = lines[1] || "";
  const buttons = [];

  for(let i=2;i<lines.length;i++){
    if(!lines[i].includes("=")) continue;
    const [title,url] = lines[i].split("=",2);
    if(url.startsWith("http")){
      buttons.push({title:title.trim(),url:url.trim()});
    }
  }
  return buttons.length ? {text,buttons} : null;
}

function addMsg(text,cls,buttons){
  document.getElementById("emptyState")?.remove();

  const d=document.createElement("div");
  d.className="msg "+cls;
  d.innerText=text;
  chat.appendChild(d);

  if(buttons){
    const b=document.createElement("div");
    b.className="buttons";
    buttons.forEach(btn=>{
      const a=document.createElement("a");
      a.href=btn.url;
      a.target="_blank";
      a.innerText=btn.title;
      b.appendChild(a);
    });
    chat.appendChild(b);
  }
  chat.scrollTop=chat.scrollHeight;
}

function send(){
  const text = txt.value.trim();
  if(!text) return;
  txt.value = "";

  addMsg(text, "user");

  const replies = matchRules(text);

  // ‚ùå BOT KH√îNG HI·ªÇU
  if(!replies.length){
    addMsg(
      "C√¢u h·ªèi n√†y em ch∆∞a r√µ üòÖ\nAnh mu·ªën g·∫∑p Admin ƒë·ªÉ h·ªèi tr·ª±c ti·∫øp kh√¥ng?",
      "bot",
      [
        {
          title: "üëâ Chat v·ªõi Admin Fanpage",
          url: "https://www.facebook.com/tdstudiogame"
        }
      ]
    );
    return;
  }

  // ‚úÖ BOT C√ì C√ÇU TR·∫¢ L·ªúI
  replies.forEach(r=>{
    const btn = parseBTN(r);
    btn
      ? addMsg(btn.text, "bot", btn.buttons)
      : addMsg(r, "bot");
  });
}

function matchRules(input){
  const plain = normalize(input);
  const out = [];
  const seen = new Set();

  for(const line of RULE_LINES){
    if(out.length>=MAX_REPLIES) break;
    if(!line.includes("|")) continue;

    const [keysPart,replyRaw] = line.split("|",2);
    const keys = keysPart.split(",").map(k=>normalize(k));

    if(keys.some(k=>phraseMatch(plain,k))){
      let r = spin(replyRaw.replace(/\\n/g,"\n"));
      if(seen.has(r)) continue;
      seen.add(r);
      out.push(r);
    }
  }
  return out;
}

txt.addEventListener("keydown",e=>{
  if(e.key==="Enter") send();
});
</script>

    </body>
</html>
